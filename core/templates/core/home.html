{% extends 'base.html' %}
{% load static %}

{% block content %}

<!-- templates/post_detail.html -->
<h1>{{ post.title }}</h1>

<img src="{{ post.image.url }}" class="img-fluid mb-3" alt="{{ post.title }}">

<p>{{ post.content }}</p>
python3
<div class="container my-5">

  <!-- ‚úÖ Welcome Banner -->
  <div class="bg-primary text-white text-center p-5 rounded shadow mb-4 position-relative overflow-hidden">
    <h1 class="display-4">{{ settings.site_name|default:"SMARTPACE" }}</h1>
    <p class="lead">{{ settings.tagline|default:"Empowering Minds Through Science" }}</p>
    <!-- Dark/Light Mode Toggle -->
    <button id="modeToggle" class="btn btn-light position-absolute top-0 end-0 m-3" style="z-index:10;">üåô</button>

    <!-- Animated background shapes -->
    <div class="animated-shape shape1"></div>
    <div class="animated-shape shape2"></div>
    <div class="animated-shape shape3"></div>
  </div>

  <!-- Clock and Calendar side by side -->
  <div class="d-flex justify-content-center align-items-center mb-5 gap-4 flex-wrap">
    <!-- Clock -->
    <div class="bg-light shadow rounded p-4 text-center flex-grow-1" style="min-width: 250px;">
      <h4 class="fw-semibold mb-3">üïí Current Time</h4>
      <div id="clock" class="fs-2 text-success fw-bold"></div>
    </div>

    <!-- Collapsible Calendar -->
    <div class="accordion flex-grow-1" style="min-width: 300px;" id="calendarAccordion">
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingCalendar">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseCalendar" aria-expanded="false" aria-controls="collapseCalendar">
            üìÖ View Calendar
          </button>
        </h2>
        <div id="collapseCalendar" class="accordion-collapse collapse" aria-labelledby="headingCalendar" data-bs-parent="#calendarAccordion">
          <div class="accordion-body p-0">
            <iframe
              title="Kenyan Holidays Calendar"
              src="https://calendar.google.com/calendar/embed?src=en.kenyan%23holiday%40group.v.calendar.google.com&ctz=Africa%2FNairobi"
              width="100%" height="300" style="border:0;" frameborder="0" scrolling="no">
            </iframe>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ‚úÖ Announcement -->
  <div class="text-center mb-4">
    <button class="btn btn-warning btn-lg fw-bold shadow-sm announcement-btn px-4 py-2" type="button" disabled>
      üì¢ {{ settings.announcement|default:"No announcements today." }}
    </button>
  </div>

  <!-- ‚úÖ Daily Fact -->
  {% if daily_fact %}
    <div class="alert alert-info text-center fw-semibold shadow-sm mb-4">
      üß¨ <strong>Daily Fact:</strong> {{ daily_fact.text }}
    </div>
  {% else %}
    <div class="alert alert-warning text-center mb-4">
      No daily fact available for today.
    </div>
  {% endif %}

  <!-- ‚úÖ Daily Quote -->
  <div class="my-4 text-center">
    <blockquote class="blockquote">
      <p class="mb-2">‚Äú{{ settings.daily_quote|default:"Science is the poetry of reality." }}‚Äù</p>
      <footer class="blockquote-footer">Daily Quote</footer>
    </blockquote>
  </div>

  <!-- ‚úÖ Featured Quiz Categories -->
  <div class="my-5">
    <h3 class="text-center mb-4">üß† Take a Quiz</h3>
    <div class="row justify-content-center">
      {% for category in quiz_categories %}
      <div class="col-md-3 col-sm-6 mb-3">
        <div class="card text-center border-success h-100 shadow-sm">
          <div class="card-body">
            <h5 class="card-title">{{ category.name }}</h5>
            <a href="{% url 'start_quiz' category.id %}" class="btn btn-outline-success mt-2">
              Take Quiz {% if category.quiz_set.count %}({{ category.quiz_set.count }}){% endif %}
            </a>
          </div>
        </div>
      </div>
      {% empty %}
      <div class="col-12">
        <p class="text-center text-muted">No quizzes available.</p>
      </div>
      {% endfor %}
    </div>
  </div>

  <!-- ‚úÖ Recent Blog Posts -->
  <div class="my-5">
    <h3 class="text-center mb-4">üìù Recent Blog Posts</h3>
    <div class="row row-cols-1 row-cols-md-3 g-4">
      {% for post in posts %}
      <div class="col">
        <div class="card h-100 shadow-sm">
          {% if post.image %}
          <img src="{{ post.image.url }}" class="card-img-top" alt="{{ post.title|default:'Blog Image' }}">
          {% endif %}
          <div class="card-body">
            <h5 class="card-title">{{ post.title }}</h5>
            <p class="card-text">{{ post.excerpt|truncatewords:20 }}</p>
            <a href="{% url 'post_detail' post.id %}" class="btn btn-primary">Read More</a>
          </div>
          <div class="card-footer text-muted small">
            {{ post.created|date:"M d, Y" }} by {{ post.author.username }}
          </div>
        </div>
      </div>
      {% empty %}
      <div class="col-12">
        <p class="text-center text-muted">No posts available.</p>
      </div>
      {% endfor %}
    </div>

    <!-- Pagination Buttons -->
    <div class="d-flex justify-content-center mt-4">
      {% if posts.has_previous %}
        <a href="?page={{ posts.previous_page_number }}" class="btn btn-outline-primary me-2">
          &laquo; Previous
        </a>
      {% else %}
        <button class="btn btn-outline-secondary me-2" disabled>&laquo; Previous</button>
      {% endif %}

      {% if posts.has_next %}
        <a href="?page={{ posts.next_page_number }}" class="btn btn-primary">
          Next &raquo;
        </a>
      {% else %}
        <button class="btn btn-secondary" disabled>Next &raquo;</button>
      {% endif %}
    </div>
  </div>

  <!-- ‚úÖ Upload & Download PDFs -->
  <div class="text-center my-5">
    <a href="{% url 'pdf_upload' %}" class="btn btn-outline-primary btn-lg me-3">
      üì§ Upload PDF
    </a>
    <a href="{% url 'pdf_list' %}" class="btn btn-outline-success btn-lg">
      üì• Download PDFs
    </a>
  </div>

</div>

<style>
  /* Animated background shapes for welcome banner */
  .animated-shape {
    position: absolute;
    border-radius: 50%;
    opacity: 0.3;
    animation: floatAnimation 8s ease-in-out infinite alternate;
  }
  .shape1 {
    width: 120px; height: 120px;
    background: #ffffff55;
    top: 10%; left: 15%;
    animation-delay: 0s;
  }
  .shape2 {
    width: 150px; height: 150px;
    background: #ffffff44;
    top: 50%; right: 10%;
    animation-delay: 3s;
  }
  .shape3 {
    width: 80px; height: 80px;
    background: #ffffff66;
    bottom: 15%; left: 50%;
    animation-delay: 6s;
  }
  @keyframes floatAnimation {
    0% { transform: translateY(0); }
    100% { transform: translateY(-20px); }
  }

  /* Announcement button style */
  .announcement-btn {
    cursor: default;
    user-select: none;
    border-radius: 30px;
    font-size: 1.25rem;
    letter-spacing: 0.05em;
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
  }
  .announcement-btn:hover {
    background-color: #ffc107cc;
    box-shadow: 0 0 10px #ffc107cc;
  }

  /* Dark mode styles */
  body.dark-mode {
    background-color: #121212 !important;
    color: #e0e0e0 !important;
  }
  body.dark-mode .bg-primary {
    background-color: #0d6efd !important;
  }
  body.dark-mode .card {
    background-color: #1e1e1e !important;
    border-color: #333 !important;
    color: #e0e0e0 !important;
  }
  body.dark-mode .btn-outline-primary {
    color: #0d6efd;
    border-color: #0d6efd;
  }
  body.dark-mode .btn-outline-primary:hover {
    background-color: #0d6efd;
    color: #fff;
  }
  body.dark-mode .alert {
    background-color: #2c2c2c !important;
    color: #e0e0e0 !important;
    border: none;
  }
  body.dark-mode iframe {
    filter: invert(90%) hue-rotate(180deg);
  }
</style>

<script>
  // Clock Script
  function updateClock() {
    const now = new Date();
    const clock = document.getElementById('clock');
    if (!clock) return;

    let hours = now.getHours();
    let minutes = now.getMinutes();
    let seconds = now.getSeconds();
    let ampm = hours >= 12 ? 'PM' : 'AM';

    hours = hours % 12;
    hours = hours ? hours : 12; // hour '0' should be 12

    clock.textContent = 
      hours.toString().padStart(2, '0') + ':' + 
      minutes.toString().padStart(2, '0') + ':' + 
      seconds.toString().padStart(2, '0') + ' ' + ampm;
  }
  setInterval(updateClock, 1000);
  updateClock();

  // Dark/Light Mode Toggle
  const modeToggle = document.getElementById('modeToggle');
  modeToggle.addEventListener('click', () => {
    document.body.classList.toggle('dark-mode');
    if(document.body.classList.contains('dark-mode')) {
      modeToggle.textContent = '‚òÄÔ∏è';
    } else {
      modeToggle.textContent = 'üåô';
    }
  });
</script>

{% endblock %}
